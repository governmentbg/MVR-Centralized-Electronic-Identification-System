<section class="container h-100" *transloco="let t">
    <p-confirmDialog [style]="{ width: '50vw' }" class="confirmation-header"></p-confirmDialog>
    <app-breadcrumb [items]="breadcrumbItems"></app-breadcrumb>
    <h4 class="mb-4">
        <ng-template [ngIf]="isEditMode">{{ t('modules.datasets.txtChange') }}</ng-template>
        <ng-template [ngIf]="!isEditMode">{{ t('modules.datasets.txtAddNew') }}</ng-template>
    </h4>
    <div class="row">
        <form [formGroup]="form" (ngSubmit)="onSubmit()" class="col-md-9 col-lg-8">
            <div class="row">
                <div class="col-xl-8">
                    <label for="datasetName" class="form-label">
                        {{ t('modules.datasets.txtDesignation') }} <span class="text-danger">*</span>
                    </label>
                    <input
                        pInputText
                        id="datasetName"
                        type="text"
                        class="w-100"
                        formControlName="datasetName"
                        [placeholder]="t('modules.datasets.txtDesignation')" />
                    <div class="text-danger validation-text">
                        <span
                            *ngIf="
                                form.controls.datasetName.invalid &&
                                (form.controls.datasetName.dirty || form.controls.datasetName.touched)
                            ">
                            {{
                                t('validations.txtPleaseEnterField', {
                                    field: t('modules.datasets.txtDesignation')
                                })
                            }}
                        </span>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-xl-8">
                    <label for="dataSource" class="form-label"
                        >{{ t('modules.datasets.txtURL') }} <span class="text-danger">*</span></label
                    >
                    <input
                        pInputText
                        id="dataSource"
                        type="text"
                        class="w-100"
                        formControlName="dataSource"
                        [placeholder]="t('modules.datasets.txtEnterUrl')" />
                    <div class="text-danger validation-text">
                        <span
                            *ngIf="
                                form.controls.dataSource.errors?.['required'] &&
                                (form.controls.dataSource.dirty || form.controls.dataSource.touched)
                            ">
                            {{
                                t('validations.txtPleaseEnterField', {
                                    field: t('modules.datasets.txtURL')
                                })
                            }}
                        </span>
                        <span
                            *ngIf="form.controls.dataSource.errors?.['urlError'] &&
                                   (form.controls.dataSource.dirty || form.controls.dataSource.touched)
                                   ">
                            {{ t('validations.txtURLError') }}
                        </span>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-xl-8">
                    <label for="description" class="form-label">{{ t('modules.datasets.txtDescription') }}</label>
                    <textarea
                        rows="3"
                        cols="20"
                        class="w-100"
                        pInputTextarea
                        maxlength="5000"
                        formControlName="description"
                        id="description"></textarea>
                    <div class="form-text">{{ t('modules.datasets.txtFieldMaxCharacterCount') }}: 5000</div>
                </div>
            </div>
            <div class="row mb-3">
                <div class="col-xl-8">
                    <p-checkbox
                        formControlName="isActive"
                        inputId="isActive"
                        ariaLabel="isActive"
                        [binary]="true"
                        [label]="t('modules.datasets.txtAutomaticPublicationOfTheData')"></p-checkbox>
                </div>
            </div>
            <div class="row">
                <div class="col-xl-8">
                    <label for="cronPeriod" class="form-label"
                        >{{ t('modules.datasets.txtRepeatability') }} <span class="text-danger">*</span></label
                    >
                    <p-dropdown
                        formControlName="cronPeriod"
                        [options]="cronPeriodTypes"
                        optionLabel="name"
                        optionValue="id"
                        styleClass="w-100"
                        inputId="cronPeriod"
                        appendTo="body"
                        [placeholder]="t('global.txtDropdownPlaceholder')">
                    </p-dropdown>
                    <div class="text-danger validation-text">
                        <span
                            *ngIf="
                                form.controls.cronPeriod.errors?.['required'] &&
                                (form.controls.cronPeriod.dirty || form.controls.cronPeriod.touched)
                            ">
                            {{
                                t('validations.txtPleaseEnterField', {
                                    field: t('modules.datasets.txtRepeatability')
                                })
                            }}
                        </span>
                    </div>
                    <p-divider class="header-divider" type="solid"></p-divider>
                </div>
            </div>
            <div class="d-flex gap-4 mt-4">
                <ng-container *ngIf="isPreviewMode; else elseBlock">
                    <p-button
                        [label]="t('global.txtBack')"
                        styleClass="p-button p-button-primary"
                        [loading]="isLoading"
                        [routerLink]="['/datasets']"></p-button>
                </ng-container>
                <ng-template #elseBlock>
                    <p-button
                        [label]="t('global.txtCancel')"
                        styleClass="p-button p-button-danger"
                        [loading]="isLoading"
                        [routerLink]="['/datasets']"></p-button>
                    <p-button
                        [label]="isEditMode ? t('modules.datasets.txtChange') : t('modules.datasets.txtAdd')"
                        type="submit"
                        [loading]="isLoading"
                        styleClass="p-button p-button-primary"></p-button>
                </ng-template>
            </div>
        </form>
    </div>
</section>
