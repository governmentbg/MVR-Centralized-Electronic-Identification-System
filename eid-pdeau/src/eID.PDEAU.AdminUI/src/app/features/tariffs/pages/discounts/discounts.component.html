<section *transloco="let t" class="h-100 datasets-container">
    <p-confirmDialog
        [style]="{ width: '50vw' }"
        [ngClass]="isConfirm ? 'confirmation-header' : 'deletion-header'"></p-confirmDialog>
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h4 class="text-uppercase">
            {{ t('modules.tariffs.discountsTable.title') }}
        </h4>
        <div class="col-3 d-flex justify-content-end align-items-end">
            <p-button
                [label]="t('modules.tariffs.discountsTable.register')"
                type="submit"
                [disabled]="discountsQuery.isLoading"
                styleClass="p-button-success"
                icon="pi pi-plus"
                iconPos="left"
                [routerLink]="['new']"></p-button>
        </div>
    </div>
    <p-card>
        <p-table
            [value]="discounts"
            [tableStyle]="{ 'min-width': '100%' }"
            dataKey="id"
            [loading]="discountsQuery.isLoading"
            loadingIcon="pi pi-spin pi-spinner"
            [rowSelectable]="false">
            <ng-template pTemplate="header">
                <tr>
                    <th class="text-nowrap">
                        {{ t('modules.tariffs.discountsTable.table.columns.startDate') }}
                    </th>
                    <th class="text-nowrap">
                        {{ t('modules.tariffs.servicesTariffsTable.table.columns.serviceName') }}
                    </th>
                    <th class="text-nowrap">
                        {{ t('modules.tariffs.discountsTable.table.columns.discount') }}
                    </th>
                    <th class="text-nowrap">
                        {{ t('modules.tariffs.discountsTable.table.columns.age') }}
                    </th>
                    <th class="text-nowrap"></th>
                </tr>
            </ng-template>
            <ng-template pTemplate="loadingbody">
                <tr>
                    <td>
                        <p-skeleton></p-skeleton>
                    </td>
                    <td>
                        <p-skeleton></p-skeleton>
                    </td>
                    <td>
                        <p-skeleton></p-skeleton>
                    </td>
                    <td>
                        <p-skeleton></p-skeleton>
                    </td>
                    <td>
                        <p-skeleton></p-skeleton>
                    </td>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-discount>
                <tr>
                    <td style="max-width: 6rem" [attr.aria-label]="discount.startDate">
                        <span class="multiline-ellipsis">{{ formatDate(discount.startDate) }}</span>
                    </td>
                    <td style="max-width: 6rem" [attr.aria-label]="discount.providedServiceId">
                        <span class="multiline-ellipsis">{{ providedServiceName(discount.providedServiceId) }}</span>
                    </td>
                    <td style="max-width: 6rem" [attr.aria-label]="discount.discount">
                        <span class="multiline-ellipsis">{{ discount.discount }}</span>
                    </td>
                    <td style="max-width: 6rem">
                        <span class="multiline-ellipsis">{{ discount.ageFrom }} - {{ discount.ageUntil }}</span>
                    </td>
                    <td style="max-width: 6rem">
                        <div class="d-flex justify-content-center align-items-center">
                            <p-button
                                [title]="t('modules.tariffs.discountsTable.table.details.edit')"
                                styleClass="p-button-sm p-button-text"
                                (click)="navigateToEdit(discount)">
                                <i class="material-icons-outlined">&#xe3c9;</i>
                            </p-button>
                            <p-button
                                [title]="t('modules.tariffs.discountsTable.table.details.delete')"
                                styleClass="p-button-sm p-button-text text-text-error"
                                (click)="deleteDiscountConfirmation(discount)">
                                <i class="material-icons-outlined">&#xe872;</i>
                            </p-button>
                        </div>
                    </td>
                </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage">
                <tr>
                    <td colspan="5">{{ t('global.txtNoRecordsFound') }}</td>
                </tr>
            </ng-template>
        </p-table>
    </p-card>
</section>
