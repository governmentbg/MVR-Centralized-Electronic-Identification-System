<section class="h-100" *transloco="let t">
    <div class="row">
        <div class="col">
            <h4 class="mb-4 text-uppercase" [attr.aria-label]="t('modules.logsViewer.txtPreview')">
                {{ t('modules.logsViewer.txtPreview') }}
            </h4>
        </div>
    </div>
    <p-card styleClass="h-100">
        <div>
            <div class="row">
                <div class="col">
                    <app-logs-filter
                        (filteredData)="onFilteredDataChange($event)"
                        (exportDataEvent)="onExportData($event)"
                        [disableExportBtn]="exportCsvRunning"></app-logs-filter>
                </div>
            </div>
            <p-table
                [value]="logs"
                [tableStyle]="{ 'min-width': '100%' }"
                [rowHover]="true"
                dataKey="id"
                [paginator]="false"
                [rows]="20"
                [showCurrentPageReport]="false"
                [loading]="loading"
                loadingIcon="pi pi-spin pi-spinner"
                [rowSelectable]="false"
                [resizableColumns]="true">
                <ng-template pTemplate="header">
                    <tr>
                        <th class="p-element text-nowrap" tabindex="0" role="columnheader" aria-sort="none">
                            {{ t('modules.logsViewer.txtEventId') }}
                        </th>
                        <th class="p-element text-nowrap" tabindex="0" role="columnheader" aria-sort="none">
                            {{ t('modules.logsViewer.txtEventType') }}
                        </th>
                        <th class="p-element text-nowrap" tabindex="0" role="columnheader" aria-sort="none">
                            {{ t('modules.logsViewer.txtEventDate') }}
                        </th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-log>
                    <tr>
                        <td [attr.aria-label]="log.eventId">
                            <span class="multiline-ellipsis">{{ log.eventId }}</span>
                        </td>
                        <td
                            [attr.aria-label]="getEventTypeTranslation(log.eventType)"
                            [title]="getEventTypeTranslation(log.eventType)">
                            <span class="multiline-ellipsis">{{ getEventTypeTranslation(log.eventType) }}</span>
                        </td>
                        <td
                            [attr.aria-label]="log.eventDate | translocoDate : { timeStyle: 'medium' }"
                            [title]="log.eventDate | translocoDate : { timeStyle: 'medium' }">
                            <span class="multiline-ellipsis">{{
                                log.eventDate | translocoDate : { timeStyle: 'medium' }
                            }}</span>
                        </td>
                    </tr>
                </ng-template>
                <ng-template pTemplate="loadingbody">
                    <tr>
                        <td>
                            <p-skeleton></p-skeleton>
                        </td>
                        <td>
                            <p-skeleton></p-skeleton>
                        </td>
                        <td>
                            <p-skeleton></p-skeleton>
                        </td>
                    </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage">
                    <tr *ngIf="logs.length === 0 && !loading">
                        <td colspan="3">
                            <span
                                class="d-flex align-items-center flex-column empty-message-container bg-background-light-grey">
                                <img src="/assets/images/noresults.png" />
                                <span class="text-text-light" [attr.aria-label]="t('global.txtNoRecordsFound')">
                                    {{ t('global.txtNoRecordsFound') }}
                                </span>
                            </span>
                        </td>
                    </tr>
                </ng-template>
            </p-table>
            <div class="text-center mt-4" *ngIf="logs.length > 0 && !loadMoreDisabled">
                <button
                    pButton
                    type="button"
                    class="p-button"
                    [loading]="loading"
                    [disabled]="loading"
                    (click)="loadLogs()"
                    [label]="t('global.txtLoadMore')"></button>
            </div>
        </div>
    </p-card>
</section>
